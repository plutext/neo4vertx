
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-09-03
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>neo4vertx - neo4vertx JavaScript Example</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/spacelab/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/default.min.css" rel="stylesheet" />

		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="shortcut icon" href="favicon.gif" type="image/x-icon"/>
	</head>

	<body class="page-example_javascript project-neo4vertx-doc" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="../">neo4vertx</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Intro <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Home">Home</a></li>
									<li ><a href="downloads.html" title="Downloads">Downloads</a></li>
									<li ><a href="maven.html" title="Maven">Maven</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="configuration.html" title="Configuration">Configuration</a></li>
									<li ><a href="javadoc" title="JavaDoc">JavaDoc</a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="active"><a href="" title="JavaScript">JavaScript</a></li>
									<li ><a href="example_cluster.html" title="Cluster Mode (Java)">Cluster Mode (Java)</a></li>
									<li ><a href="example_remote.html" title="Remote Mode (Java)">Remote Mode (Java)</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<div id="bannerLeft"><img src="neo4vertx_small.png" alt='"''"' /></div>
					<p class="lead">Bridging the gap between Vert.x and Neo4j</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="page-header">
 <h1 id="neo4vertx_javascript_example">neo4vertx JavaScript Example</h1>
</div> 
<p>This example shows the basic usage of neo4vertx. This example is only meant to show conceptually how neo4vertx works. We send a Cypher query directly from the client.js, utilizing the Vert.x eventbus Javascript bridge. In real life you should probably not do this, as exposing the Cypher REST api in this way will effectively allow anyone with access to your site to fire ANY kind of Cypher REST query at your Neo4j instance.</p> 
<p>Ideally, one would create backend verticles that handle all sorts of abstract things, utilizing neo4vertx; the client.js would then talk to these backend verticles instead!</p> 
<p>Follow the steps below to run the example.</p> 
<div class="section"> 
 <div class="section"> 
  <h3 id="Start_the_application">Start the application</h3> 
  <blockquote> 
   <p>vertx run app.js</p> 
  </blockquote> 
  <p>If this is the first time you run the example, you’ll see vertx downloading and deploying 2 modules (mod-web-server and ofcourse neo4vertx). Now that the modules are deployed, let’s run the example:</p> 
 </div> 
 <div class="section"> 
  <h3 id="Run_the_example">Run the example</h3> 
  <p>Open <a class="externalLink" href="http://localhost:8080/">http://localhost:8080/</a> in a webbrowser to run the example (you can see the output of client.js in the webconsole). It should look something like this:</p> 
  <div class="source"> 
   <pre>&quot;Eventbus connected&quot;
&quot;displayResult() received the following result: &quot;
Object { columns: Array[1], data: Array[0] }
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Open_the_neo4j_browser">Open the neo4j browser</h3> 
  <p>Open <a class="externalLink" href="http://localhost:7474/">http://localhost:7474/</a> to see the neo4j browser.</p> 
  <hr /> 
  <h1 id="some_more_details">Some more details</h1> 
  <p>Now that we’ve succesfully run the example, let’s take a closer look at the code. The application basically consists of 3 files:</p> 
  <ul> 
   <li>app.js (server-side code)</li> 
   <li>web/client.js (client-side code)</li> 
   <li>web/index.html (the delivery method for the client-side code)</li> 
  </ul> 
  <p>Let’s take a look at the server-side code!</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Server-side_code_appjs">Server-side code (app.js)</h2> 
 <div class="section"> 
  <h3 id="Requires">Requires</h3> 
  <p>First off, we include container and console.</p> 
  <div class="source"> 
   <pre>var container = require(&quot;vertx/container&quot;),
    console = require(&quot;vertx/console&quot;);
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Configure_the_modules">Configure the modules</h3> 
  <p>Then we’ll define the configuration for the two modules which we’ll deploy; <i>mod-web-server</i> and <i>neo4vertx</i>. The configuration parameters all pretty much speak for themselves, for complete information see <a class="externalLink" href="https://github.com/vert-x/mod-web-server#configuration">mod-web-server </a> and <a class="externalLink" href="https://github.com/raaftech/neo4vertx#configuration">neo4vertx</a> configuration documentation.</p> 
  <div class="source"> 
   <pre>// webserver configuration
var webServerConfig = {
    port: 8080,
    host: &quot;0.0.0.0&quot;,
    bridge: true,
    inbound_permitted: [
        { address_re: 'neo4j-graph.*' }
    ]
};
// neo4vertx configuration
var neo4jConfig = {
    mode: &quot;default&quot;,
    path: &quot;/tmp/db&quot;,
    baseAddress: &quot;neo4j-graph&quot;
};
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Deploy_the_modules">Deploy the modules</h3> 
  <p>On the server-side we deploy a webserver-module and the neo4vertx module:</p> 
  <div class="source"> 
   <pre>// deploy mod-web-server
container.deployModule(&quot;io.vertx~mod-web-server~2.0.0-final&quot;, webServerConfig, 1, deploymentCompleteHandler);

// deploy neo4vertx
container.deployModule(&quot;org.openpcf~neo4vertx~1.3.2&quot;, neo4jConfig, 1, deploymentCompleteHandler);
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Deployment_results">Deployment results</h3> 
  <p>Each deployment calls <i>deploymentCompleteHandler(error, deploymentID)</i> when it’s done deploying this notifies the user of the deploymentID when the deployment succeeded or the error if something went wrong.</p> 
  <div class="source"> 
   <pre>// display deployment status
function deploymentCompleteHandler(error, deploymentID){
    if (error) {
        console.log(&quot;Something went wrong with deployment: &quot;);
        console.log(error)
    } else {
        console.log(&quot;Deployment Completed succesfully, deployment ID: &quot; + deploymentID);
    }
}
</pre> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Client-side_code_clientjs">Client-side code (client.js)</h2> 
 <div class="section"> 
  <h3 id="Connect_to_the_EventBus">Connect to the EventBus</h3> 
  <p>On the client-side we create a new EventBus:</p> 
  <div class="source"> 
   <pre>var eventBus = new vertx.EventBus(window.location.protocol + '//' +
                            window.location.hostname + ':' +
                            window.location.port + '/eventbus');
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Query_function">Query function</h3> 
  <p>We define a function <i>doQuery(querystring, callback)</i> which sends a querystring on the eventbus to be executed and calls the <i>callback</i> with the results.</p> 
  <div class="source"> 
   <pre>// Execute a Cypher query and call the callback with the results
function doQuery(querystring, callback) {

    // Json object containing our very simple querystring
    var queryJsonObject = { &quot;query&quot;: querystring };

    // Put the query message on the eventbus
    eventBus.send(
        'neo4j-graph.cypher.query',
        queryJsonObject,
        callback
    );
}
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Callback_function">Callback function</h3> 
  <p>The callback <i>displayResults(results)</i> notifies the user on the console what the results were.</p> 
  <div class="source"> 
   <pre>function displayResult(result) { 
    
    // Display query result(s)
    console.log(&quot;displayResult() received the following result: &quot;);
    console.log(result);
}
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Execute_a_query">Execute a query</h3> 
  <p>As soon as we’re connected to the eventbus (<i>eventBus.onopen</i>), we notify the user of this through the console, execute a Cypher query (using <i>doQuery</i> defined earlier) and then display the results using the passed callback (<i>displayResults</i>).</p> 
  <div class="source"> 
   <pre>// Fire when connected to the eventbus
eventBus.onopen = function eventbusConnected() {

  // Our very simple query string
  var simpleQuerystring = &quot;MATCH (n) RETURN n&quot;;

  // Notify user that eventbus is connected
  console.log(&quot;Eventbus connected&quot;);
  
  // Execute a Cypher query and use callbackFunction() to display the results
  doQuery(simpleQuerystring, displayResult);
}
</pre> 
  </div> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#neo4vertx_javascript_example" title="neo4vertx JavaScript Example">neo4vertx JavaScript Example <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Start_the_application" title="Start the application">Start the application</a>
		<li><a href="#Run_the_example" title="Run the example">Run the example</a>
		<li><a href="#Open_the_neo4j_browser" title="Open the neo4j browser">Open the neo4j browser</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#some_more_details" title="Some more details">Some more details <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li class="dropdown"><a href="#Server-side_code_appjs" title="Server-side code (app.js)">Server-side code (app.js) <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Requires" title="Requires">Requires</a>
		<li><a href="#Configure_the_modules" title="Configure the modules">Configure the modules</a>
		<li><a href="#Deploy_the_modules" title="Deploy the modules">Deploy the modules</a>
		<li><a href="#Deployment_results" title="Deployment results">Deployment results</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Client-side_code_clientjs" title="Client-side code (client.js)">Client-side code (client.js) <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Connect_to_the_EventBus" title="Connect to the EventBus">Connect to the EventBus</a>
		<li><a href="#Query_function" title="Query function">Query function</a>
		<li><a href="#Callback_function" title="Callback function">Callback function</a>
		<li><a href="#Execute_a_query" title="Execute a query">Execute a query</a>
				<li class="divider"></li>
			</ul>
		</li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Intro</li>
						<li >
							<a href="index.html" title="Home">Home</a>
						</li>
						<li >
							<a href="downloads.html" title="Downloads">Downloads</a>
						</li>
						<li >
							<a href="maven.html" title="Maven">Maven</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Project Info</li>
						<li >
							<a href="changelog.html" title="Changelog">Changelog</a>
						</li>
						<li >
							<a href="contributing.html" title="Contributing">Contributing</a>
						</li>
						<li >
							<a href="https://github.com/raaftech/neo4vertx" title="Github" class="externalLink">Github</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li >
							<a href="configuration.html" title="Configuration">Configuration</a>
						</li>
						<li >
							<a href="javadoc" title="JavaDoc">JavaDoc</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Examples</li>
						<li class="active">
							<a href="#" title="JavaScript">JavaScript</a>
						</li>
						<li >
							<a href="example_cluster.html" title="Cluster Mode (Java)">Cluster Mode (Java)</a>
						</li>
						<li >
							<a href="example_remote.html" title="Remote Mode (Java)">Remote Mode (Java)</a>
						</li>
					</ul>
				</div>
				<div class="span4 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014 <a href="https://www.openpcf.org/">Open Provisioning and Control Framework</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>

	</body>
</html>