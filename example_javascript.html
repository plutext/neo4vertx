
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-09-03
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>neo4vertx - neo4vertx JavaScript Example ===========================</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/spacelab/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/default.min.css" rel="stylesheet" />

		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="shortcut icon" href="favicon.gif" type="image/x-icon"/>
	</head>

	<body class="page-example_javascript project-neo4vertx-doc" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="../">neo4vertx</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Intro <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Home">Home</a></li>
									<li ><a href="downloads.html" title="Downloads">Downloads</a></li>
									<li ><a href="maven.html" title="Maven">Maven</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="configuration.html" title="Configuration">Configuration</a></li>
									<li ><a href="javadoc" title="JavaDoc">JavaDoc</a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="active"><a href="" title="JavaScript">JavaScript</a></li>
									<li ><a href="example_cluster.html" title="Cluster Mode (Java)">Cluster Mode (Java)</a></li>
									<li ><a href="example_remote.html" title="Remote Mode (Java)">Remote Mode (Java)</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<div id="bannerLeft"><img src="neo4vertx_small.png" alt='"''"' /></div>
					<p class="lead">Bridging the gap between Vert.x and Neo4j</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="neo4vertx_JavaScript_Example_">neo4vertx JavaScript Example ===========================</h2>
 </div> 
</div> 
<div class="section"> 
 <h2 id="This_example_shows_the_basic_usage_of_neo4vertx_This_example_is_only_meant_to_show_conceptually_how_neo4vertx_works_We_send_a_Cypher_query_directly_from_the_clientjs_utilizing_the_Vertx_eventbus_Javascript_bridge_In_real_life_you_should_probably_not_do_this_as_exposing_the_Cypher_REST_api_in_this_way_will_effectively_allow_anyone_with_access_to_your_site_to_fire_ANY_kind_of_Cypher_REST_query_at_your_Neo4j_instance">This example shows the basic usage of neo4vertx. This example is only meant to show conceptually how neo4vertx works. We send a Cypher query directly from the client.js, utilizing the Vert.x eventbus Javascript bridge. In real life you should probably not do this, as exposing the Cypher REST api in this way will effectively allow anyone with access to your site to fire ANY kind of Cypher REST query at your Neo4j instance.</h2> 
</div> 
<div class="section"> 
 <h2 id="Ideally_one_would_create_backend_verticles_that_handle_all_sorts_of_abstract_things_utilizing_neo4vertx_the_clientjs_would_then_talk_to_these_backend_verticles_instead">Ideally, one would create backend verticles that handle all sorts of abstract things, utilizing neo4vertx; the client.js would then talk to these backend verticles instead!</h2> 
</div> 
<div class="section"> 
 <h2 id="Follow_the_steps_below_to_run_the_example">Follow the steps below to run the example.</h2> 
</div> 
<div class="section"> 
 <h2 id="a_vertx_run_appjs">&gt; vertx run app.js</h2> 
</div> 
<div class="section"> 
 <h2 id="If_this_is_the_first_time_you_run_the_example_youll_see_vertx_downloading_and_deploying_2_modules_mod-web-server_and_ofcourse_neo4vertx_Now_that_the_modules_are_deployed_lets_run_the_example">If this is the first time you run the example, you'll see vertx downloading and deploying 2 modules (mod-web-server and ofcourse neo4vertx). Now that the modules are deployed, let's run the example:</h2> 
</div> 
<div class="section"> 
 <h2 id="Open_httplocalhost8080httplocalhost8080_in_a_webbrowser_to_run_the_example_you_can_see_the_output_of_clientjs_in_the_webconsole_It_should_look_something_like_this">Open [http://localhost:8080/](http://localhost:8080/) in a webbrowser to run the example (you can see the output of client.js in the webconsole). It should look something like this:</h2> 
</div> 
<div class="section"> 
 <h2 id="columns_Array1_data_Array0">``` &quot;Eventbus connected&quot; &quot;displayResult() received the following result: &quot; Object ```<a name="a_Eventbus_connected_displayResult_received_the_following_result:__Object__columns:_Array1_data:_Array0__"></a></h2> 
</div> 
<div class="section"> 
 <h2 id="Open_httplocalhost7474httplocalhost7474_to_see_the_neo4j_browser">Open [http://localhost:7474/](http://localhost:7474/) to see the neo4j browser.</h2> 
 <div> 
  <pre>

# Some more details
Now that we've succesfully run the example, let's take a closer look at the 
code. The application basically consists of 3 files:

 - app.js (server-side code)
 - web/client.js (client-side code)
 - web/index.html (the delivery method for the client-side code)

Let's take a look at the server-side code!




First off, we include container and console.

```
var container = require(&quot;vertx/container&quot;),
    console = require(&quot;vertx/console&quot;);
```


Then we'll define the configuration for the two modules which we'll deploy; 
_mod-web-server_ and _neo4vertx_. The configuration parameters all pretty 
much speak for themselves, for complete information see 
[mod-web-server ](https://github.com/vert-x/mod-web-server#configuration) and 
[neo4vertx](https://github.com/raaftech/neo4vertx#configuration) configuration 
documentation.

```
// webserver configuration
var webServerConfig = {
    port: 8080,
    host: &quot;0.0.0.0&quot;,
    bridge: true,
    inbound_permitted: [
        { address_re: 'neo4j-graph.*' }
    ]
};
// neo4vertx configuration
var neo4jConfig = {
    mode: &quot;default&quot;,
    path: &quot;/tmp/db&quot;,
    baseAddress: &quot;neo4j-graph&quot;
};
```

On the server-side we deploy a webserver-module and the neo4vertx module:

```
// deploy mod-web-server
container.deployModule(&quot;io.vertx~mod-web-server~2.0.0-final&quot;, webServerConfig, 1, deploymentCompleteHandler);

// deploy neo4vertx
container.deployModule(&quot;org.openpcf~neo4vertx~1.3.2&quot;, neo4jConfig, 1, deploymentCompleteHandler);
```


Each deployment calls _deploymentCompleteHandler(error, deploymentID)_ when 
it's done deploying this notifies the user of the deploymentID when the 
deployment succeeded or the error if something went wrong.

```
// display deployment status
function deploymentCompleteHandler(error, deploymentID){
    if (error) {
        console.log(&quot;Something went wrong with deployment: &quot;);
        console.log(error)
    } else {
        console.log(&quot;Deployment Completed succesfully, deployment ID: &quot; + deploymentID);
    }
}
```





On the client-side we create a new EventBus:

```
var eventBus = new vertx.EventBus(window.location.protocol + '//' +
                            window.location.hostname + ':' +
                            window.location.port + '/eventbus');
```


We define a function _doQuery(querystring, callback)_ which sends a querystring 
on the eventbus to be executed and calls the _callback_ with the results.

```
// Execute a Cypher query and call the callback with the results
function doQuery(querystring, callback) {

    // Json object containing our very simple querystring
    var queryJsonObject = { &quot;query&quot;: querystring };

    // Put the query message on the eventbus
    eventBus.send(
        'neo4j-graph.cypher.query',
        queryJsonObject,
        callback
    );
}
```


The callback _displayResults(results)_ notifies the user on the console 
what the results were.

```
function displayResult(result) { 
    
    // Display query result(s)
    console.log(&quot;displayResult() received the following result: &quot;);
    console.log(result);
}
```


As soon as we're connected to the eventbus (_eventBus.onopen_), we notify the 
user of this through the console, execute a Cypher query (using _doQuery_ defined earlier) and then display the results using the passed callback (_displayResults_).

```
// Fire when connected to the eventbus
eventBus.onopen = function eventbusConnected() {

  // Our very simple query string
  var simpleQuerystring = &quot;MATCH (n) RETURN n&quot;;

  // Notify user that eventbus is connected
  console.log(&quot;Eventbus connected&quot;);
  
  // Execute a Cypher query and use callbackFunction() to display the results
  doQuery(simpleQuerystring, displayResult);
}
```</pre> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li><a href="#neo4vertx_JavaScript_Example_" title="neo4vertx JavaScript Example ===========================">neo4vertx JavaScript Example ===========================</a>
		<li><a href="#This_example_shows_the_basic_usage_of_neo4vertx_This_example_is_only_meant_to_show_conceptually_how_neo4vertx_works_We_send_a_Cypher_query_directly_from_the_clientjs_utilizing_the_Vertx_eventbus_Javascript_bridge_In_real_life_you_should_probably_not_do_this_as_exposing_the_Cypher_REST_api_in_this_way_will_effectively_allow_anyone_with_access_to_your_site_to_fire_ANY_kind_of_Cypher_REST_query_at_your_Neo4j_instance" title="This example shows the basic usage of neo4vertx. This example is only meant to show conceptually how neo4vertx works. We send a Cypher query directly from the client.js, utilizing the Vert.x eventbus Javascript bridge. In real life you should probably not do this, as exposing the Cypher REST api in this way will effectively allow anyone with access to your site to fire ANY kind of Cypher REST query at your Neo4j instance.">This example shows the basic usage of neo4vertx. This example is only meant to show conceptually how neo4vertx works. We send a Cypher query directly from the client.js, utilizing the Vert.x eventbus Javascript bridge. In real life you should probably not do this, as exposing the Cypher REST api in this way will effectively allow anyone with access to your site to fire ANY kind of Cypher REST query at your Neo4j instance.</a>
		<li><a href="#Ideally_one_would_create_backend_verticles_that_handle_all_sorts_of_abstract_things_utilizing_neo4vertx_the_clientjs_would_then_talk_to_these_backend_verticles_instead" title="Ideally, one would create backend verticles that handle all sorts of abstract things, utilizing neo4vertx; the client.js would then talk to these backend verticles instead!">Ideally, one would create backend verticles that handle all sorts of abstract things, utilizing neo4vertx; the client.js would then talk to these backend verticles instead!</a>
		<li><a href="#Follow_the_steps_below_to_run_the_example" title="Follow the steps below to run the example.">Follow the steps below to run the example.</a>
		<li><a href="#a_vertx_run_appjs" title="> vertx run app.js">> vertx run app.js</a>
		<li><a href="#If_this_is_the_first_time_you_run_the_example_youll_see_vertx_downloading_and_deploying_2_modules_mod-web-server_and_ofcourse_neo4vertx_Now_that_the_modules_are_deployed_lets_run_the_example" title="If this is the first time you run the example, you'll see vertx downloading and deploying 2 modules (mod-web-server and ofcourse neo4vertx). Now that the modules are deployed, let's run the example:">If this is the first time you run the example, you'll see vertx downloading and deploying 2 modules (mod-web-server and ofcourse neo4vertx). Now that the modules are deployed, let's run the example:</a>
		<li><a href="#Open_httplocalhost8080httplocalhost8080_in_a_webbrowser_to_run_the_example_you_can_see_the_output_of_clientjs_in_the_webconsole_It_should_look_something_like_this" title="Open [http://localhost:8080/](http://localhost:8080/) in a webbrowser to run the example (you can see the output of client.js in the webconsole). It should look something like this:">Open [http://localhost:8080/](http://localhost:8080/) in a webbrowser to run the example (you can see the output of client.js in the webconsole). It should look something like this:</a>
		<li><a href="#columns_Array1_data_Array0" title="``` "Eventbus connected" "displayResult() received the following result: " Object ```">``` "Eventbus connected" "displayResult() received the following result: " Object ```</a>
		<li><a href="#Open_httplocalhost7474httplocalhost7474_to_see_the_neo4j_browser" title="Open [http://localhost:7474/](http://localhost:7474/) to see the neo4j browser.">Open [http://localhost:7474/](http://localhost:7474/) to see the neo4j browser.</a>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Intro</li>
						<li >
							<a href="index.html" title="Home">Home</a>
						</li>
						<li >
							<a href="downloads.html" title="Downloads">Downloads</a>
						</li>
						<li >
							<a href="maven.html" title="Maven">Maven</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Project Info</li>
						<li >
							<a href="changelog.html" title="Changelog">Changelog</a>
						</li>
						<li >
							<a href="contributing.html" title="Contributing">Contributing</a>
						</li>
						<li >
							<a href="https://github.com/raaftech/neo4vertx" title="Github" class="externalLink">Github</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li >
							<a href="configuration.html" title="Configuration">Configuration</a>
						</li>
						<li >
							<a href="javadoc" title="JavaDoc">JavaDoc</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Examples</li>
						<li class="active">
							<a href="#" title="JavaScript">JavaScript</a>
						</li>
						<li >
							<a href="example_cluster.html" title="Cluster Mode (Java)">Cluster Mode (Java)</a>
						</li>
						<li >
							<a href="example_remote.html" title="Remote Mode (Java)">Remote Mode (Java)</a>
						</li>
					</ul>
				</div>
				<div class="span4 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014 <a href="https://www.openpcf.org/">Open Provisioning and Control Framework</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>

	</body>
</html>